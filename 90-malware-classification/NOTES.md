# Notes — Malware Classification

## 1) What is Malware?
Malware is any software or code designed to harm, exploit, or otherwise perform unwanted actions on systems or data. Attackers design malware to steal data, disrupt services, gain persistent access, or monetize access (e.g., by ransomware).

## 2) Key Malware Categories (short definitions)
- **Virus:** Code that attaches to other programs/files and spreads when those files are executed. Requires user or host action to spread.
- **Worm:** Self-replicating malware that spreads across networks without user interaction.
- **Trojan:** Malware disguised as legitimate software; it tricks users into installing it.
- **Ransomware:** Encrypts files or systems and demands payment for restoration.
- **Spyware/Keylogger:** Collects user data, keystrokes, or browsing habits covertly.
- **Backdoor:** Provides unauthorized remote access to a system.
- **Botnet (Bot):** Network of compromised machines controlled by C2 (command & control).
- **Rootkit:** Hides presence by modifying OS/kernel; used for persistence and stealth.
- **Adware:** Displays unwanted advertisements and may track user behavior.
- **Logic Bomb:** Triggered by a specific condition or date.

## 3) Binary vs Script Malware
- **Binary malware:** Compiled executables (PE files on Windows, ELF on Linux, Mach-O on macOS). Analysis uses static (headers, strings, imports) and dynamic (sandbox execution, API call tracing) techniques.
- **Script malware:** Written in interpreted languages (PowerShell, Python, JavaScript, Bash). Often easy to read but may be obfuscated (encoded, compressed, or packed).

## 4) Core Analysis Steps (Safe, controlled environment)
1. **Safety first:** Work in an isolated VM or sandbox with no host connectivity. Snapshot clean state.
2. **Static triage:** `file`, `strings`, hashes (`md5/sha256`), `exiftool`, check PE/ELF headers, imports.
3. **Quick heuristics:** Look for suspicious strings (C2 domains, IPs, suspicious functions like CreateRemoteThread, VirtualAlloc, Process injection markers).
4. **YARA / signature check:** Match known patterns to quickly classify family or behaviour.
5. **Dynamic analysis:** Run in sandbox to monitor file system, registry (Windows), network connections, processes, and persistence mechanisms. Capture PCAP.
6. **Behavioral classification:** Based on actions (encrypts files → ransomware; contacts many hosts and spreads → worm; installs keylogger → spyware).
7. **Report & containment:** Isolate infected hosts, remove persistence, block C2, and recover via backups if needed.

## 5) Real-World Indicators & Examples (summary style)
- **Ransomware:** Looks for file-encryption routines, deletes shadow copies, creates ransom note, opens port for payment instructions.
- **Spyware/Keylogger:** Hooks keyboard APIs, exfiltrates logs to remote server.
- **Botnet client:** Periodic beaconing to C2, receives commands, offers DDoS or spamming functionality.
- **Trojan dropper:** Small stub that downloads and executes a larger payload.

## 6) SOC Response vs Malware Type
- **Containment:** Isolate infected host (network-level block).
- **Eradication:** Remove malware & persistence.
- **Recovery:** Restore files from backups (for ransomware).
- **Hunt & patch:** Look for other infected systems, patch exploited vulnerabilities.
- **IOC sharing:** Share indicators (hashes, domains, YARA) with peers.

## 7) Responsible Use
- Never analyze unknown malware on production systems.
- Use air-gapped or snapshot-enabled VMs/sandboxes.
- Preserve evidence if suspected criminal activity is involved.

