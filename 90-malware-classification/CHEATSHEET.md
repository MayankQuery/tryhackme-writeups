# Cheatsheet — Quick Commands, YARA, Filters

## Quick static triage commands
- Identify file type:
  - `file sample.bin`
- Hashes:
  - `md5sum sample.bin && sha256sum sample.bin`
- Strings:
  - `strings -a -n 8 sample.bin | less`
- Basic metadata:
  - `exiftool sample.bin`
- PE details (Windows):
  - `objdump -x sample.exe` or use `pefile` in Python
- ELF details (Linux):
  - `readelf -h sample.elf`

## Quick dynamic / sandbox capture
- Capture network while running sample in VM (host side):
  - `sudo tcpdump -i <iface> -w sample.pcap`
- Monitor file changes (Linux):
  - `inotifywait -m /path/to/watch`
- Windows: use Procmon, Process Explorer, and network monitoring in sandbox

## YARA quick examples
- **Detect obvious C2 strings or suspicious patterns**
```r
rule suspicious_c2 {
meta:
author = "MayankQuery-cheatsheet"
description = "Simple rule to detect basic C2 strings or ransom note phrases"
strings:
$s1 = "BEGIN RSA" nocase
$s2 = "decrypt" nocase
$s3 = "ransom" nocase
$c2 = /https?://[A-Za-z0-9.-]+.[A-Za-z]{2,}/[A-Za-z0-9_-]+/
condition:
any of ($s*) or $c2
}
```

## Useful strings to search for
- Network: `http://`, `https://`, `.onion`, IP patterns `\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}`
- Persistence: `Run`, `HKCU\Software\Microsoft\Windows\CurrentVersion\Run`, `crontab`
- Encryption/ransom: `ENCRYPT`, `KEY`, `PAYMENT`, `README`, `DECRYPT`

## Wireshark/TCPDump filters (PCAP analysis)
- Show HTTP traffic: `http`
- Show DNS queries: `dns`
- Show connections to an IP: `host 1.2.3.4`
- Show TCP SYNs: `tcp.flags.syn == 1 && tcp.flags.ack == 0`

## Heuristics / thresholds (SOC)
- Frequent periodic beaconing (e.g., every 30s–5min) → likely C2 beacon.
- Outbound connections to many unique IPs shortly after execution → potential worm or mass-scanner.
- Unusual process spawning child processes repeatedly → potential injection/dropper behavior.
